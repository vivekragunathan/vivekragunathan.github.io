<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xml:lang="en" lang="en" >

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="generator" content="Hugo 0.121.2">

	<title>Optional Parameters &middot; A Developer&#39;s Experience</title>

	<meta name="description" content="" />

	

<meta itemprop="name" content="Optional Parameters">
<meta itemprop="description" content="The billion dollar mistake has been committed already. No going back. But it is not necessary to keep repeating it. Oh, I am talking about the infamous null. Would Java&rsquo;s Optional come to the rescue? Or are there any ironic &ldquo;Don&rsquo;ts&rdquo; when using Optional?"><meta itemprop="datePublished" content="2023-10-03T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-10-03T00:00:00+00:00" />
<meta itemprop="wordCount" content="964">
<meta itemprop="keywords" content="java,optional,scala," />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Optional Parameters"/>
<meta name="twitter:description" content="The billion dollar mistake has been committed already. No going back. But it is not necessary to keep repeating it. Oh, I am talking about the infamous null. Would Java&rsquo;s Optional come to the rescue? Or are there any ironic &ldquo;Don&rsquo;ts&rdquo; when using Optional?"/>


<meta property="og:title" content="Optional Parameters" />
<meta property="og:description" content="The billion dollar mistake has been committed already. No going back. But it is not necessary to keep repeating it. Oh, I am talking about the infamous null. Would Java&rsquo;s Optional come to the rescue? Or are there any ironic &ldquo;Don&rsquo;ts&rdquo; when using Optional?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/optional-parameters/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-10-03T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-10-03T00:00:00+00:00" />




	<link type="text/css" rel="stylesheet" href="/css/print.css" media="print">

	<link type="text/css" rel="stylesheet" href="/css/poole.css">

	<link type="text/css" rel="stylesheet" href="/css/hyde.css">

	
<style type="text/css">
  .sidebar {
    background-color: #347B98;
  }

  .read-more-link a {
    border-color: #347B98;
  }

  .pagination li a {
    color: #347B98;
    border: 1px solid #347B98;
  }

  .pagination li.active a {
    background-color: #347B98;
  }

  .pagination li a:hover {
    background-color: #347B98;
    opacity: 0.75;
  }

  footer a,
  .content a,
  .related-posts li a:hover {
    color: #347B98;
  }
</style>



	<link type="text/css" rel="stylesheet" href="/css/blockquote.css"><link type="text/css" rel="stylesheet" href="/css/custom.css">

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
		integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />

	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144-precomposed.png">

	<link rel="shortcut icon" href="/images/favicon.png">

	
	</head>

<body>
	<aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
        <div class="author-image">
          <a href="/">
            <img 
              src="/images/profile.png" 
              class="img-circle img-headshot center" 
              alt="Profile Picture">
          </a>
        </div>
        
      

      <h1>A Developer&#39;s Experience</h1>

      
      <p class="lead">The romantic image of an über-programmer is someone who fires up Emacs, types like a machine gun, and delivers a flawless final product from scratch. A more accurate image would be someone who stares quietly into space for a few minutes and then says Hmm. I think I’ve seen something like this before – John D. Cook</p>
      
    </div>

    <hr />

    <nav>
      <ul class="sidebar-nav">
        
        <li>
          <a href="/post/">Posts</a>
        </li><li>
          <a href="/pages">Pages</a>
        </li><li>
          <a href="/about/">About</a>
        </li><li>
          <a href="/quotations">Qs</a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://stackoverflow.com/users/495612" rel="me" title="Stackoverflow" target="_blank">
        <i class="fab fa-stack-overflow" aria-hidden="true"></i>
      </a>
      
      <a href="https://github.com/vivekragunathan" rel="me" title="GitHub" target="_blank">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="https://twitter.com/higherkindedtpe" rel="me" title="Twitter" target="_blank">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      
    </section>

    <section class="blog-search-section">
      <div class="blog-search-box">
	
	<button class="blog-search-btn"><i class="fas fa-search"></i></button>
	<input type="text" class="blog-search-input" placeholder="Type to Search...">

	<form style='display: none;' action='/search/' method="get">
		<input name="q" type="text">
	</form>
</div>
    </section>
  </div>
</aside>


	<main class="content container">
		<div class="post">
  
  <div class="image featured ">
  	
	</div>

  <h1>Optional Parameters</h1>


  <div class="post-date">
    <time datetime="2023-10-03T00:00:00Z">Oct 3, 2023</time> &middot; 5 min read
  </div>

  <p>The billion dollar mistake has been committed already. No going back. But it is not necessary to keep repeating it. Oh, I am talking about the infamous <code>null</code>.</p>
<p>A real solution to avert the issues surrounding <code>null</code> is to completely avoid using it in your code, and replace direct use of <code>null</code> with some sort of nullable container, such as the <code>Option[A]</code> in Scala. You could go even as far and enforce not to use <code>null</code> anywhere in your code via <a href="https://www.scalastyle.org/">Scalastyle</a> or other linters.</p>
<p>In Scala, it is pretty common to pass and return<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> <code>Option</code>. For instance &hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">case</span> <span class="k">class</span> <span class="nc">Email</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">	<span class="n">subject</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">	<span class="n">body</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">	<span class="n">attachment</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Attachment</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">object</span> <span class="nc">Email</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">subject</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">body</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Email</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">		<span class="k">new</span> <span class="nc">Email</span><span class="o">(</span><span class="n">subject</span><span class="o">,</span> <span class="n">string</span><span class="o">,</span> <span class="n">attachment</span> <span class="k">=</span> <span class="nc">None</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>In the above code, <code>attachment</code> may <em>optionally</em> be passed to create an instance of <code>Email</code>. Another way, a bad one, to achieve the same with sufficient safety around <code>null</code> is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">#</span> <span class="nc">This</span> <span class="n">is</span> <span class="n">bad</span><span class="o">!</span> <span class="nc">Don</span>&#39;t <span class="k">do</span> <span class="n">it</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Email</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">	<span class="k">val</span> <span class="n">subject</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">	<span class="k">val</span> <span class="n">body</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">	<span class="n">attached</span><span class="k">:</span> <span class="kt">Attachment</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">val</span> <span class="n">attachment</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Attachment</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Option</span><span class="o">(</span><span class="n">attached</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// calling code
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">new</span> <span class="nc">Email</span><span class="o">(</span><span class="s">&#34;hello&#34;</span><span class="o">,</span> <span class="s">&#34;world&#34;</span><span class="o">,</span> <span class="kc">null</span><span class="o">)</span>
</span></span></code></pre></div><p>The above code does not use <code>Option</code> but directly use <code>null</code>, which is wrapped with an <code>Option</code> inside the Email class. While this provides safety net around <code>null</code>, it is just a bad way.</p>
<p>Introducing <code>null</code> in one place potentially causes loss in the strictness of types. The <code>null</code>  may be direct value as shown in the example above. Or a runtime value passed down via chain of calls to a variable passed to <code>Email</code> constructor, which makes it harder to reason about. Besides, did you notice I had to change the original <code>case class</code> to a regular <code>class</code><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>?</p>
<p>Let us switch gears. Java too has a nullable container - the infamous<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> <code>Optional&lt;T&gt;</code>.</p>
<p>In the Java realm, returning <code>Optional</code> from methods is acceptable. Passing <code>Optional</code> as parameters is not.</p>
<p>IntelliJ warns such cases via its <a href="https://www.jetbrains.com/help/idea/code-inspection.html">inspections</a>.
<img src="/images/2023-10-03-opt.jpg" alt="opt.jpg"></p>
<p>While you can suppress inspections at your will, that is the not point. It is recommended not to pass <code>Optional</code> as parameters. <a href="https://stackoverflow.com/a/26328555">Even by Java experts</a>.</p>
<p><img src="/images/2023-10-03-opt2.jpg" alt="opt2.jpg"></p>
<p>I was not able to find a compelling reason behind such a recommendation, which is in contrast to Scala. Almost every link or material I came across was about to disabling<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> the inspection to silence IntelliJ from throwing the warning.</p>
<p>However, I came across a couple of things where were better out of the lot. <strong>But not compelling</strong>.</p>
<ul>
<li>In the case when there are multiple <code>Optional</code> parameters, the calling code would look <a href="http://dolszewski.com/java/java-8-optional-use-cases/">clumsy</a>. Meh! Real production Java code is ugly 🤷‍♂️ because Java syntax is verbose and noisy. I don&rsquo;t buy that multiple <code>Optional</code> parameters is going to make uglier.</li>
<li>Using <code>Optional</code> parameters <a href="https://stackoverflow.com/a/31923105">introduces</a> conditional logic in the method. Of course, it should. Wouldn&rsquo;t there be conditional logic or guards if we were dealing with <code>null</code> instead of <code>Optional</code>? Only <code>Optional</code> makes it disciplined. You wouldn&rsquo;t use the parameter in question blindly without null check, would you?</li>
<li><code>Optional</code> is relatively <a href="https://stackoverflow.com/a/31923105">expensive</a>. This is a hard sell unless one can prove that <code>Optional</code> in the particular case is the bottleneck. In the grand scheme of things, the cost of <code>Optional</code> should be negligible. Unless it can be proven it is not negligible.
<ul>
<li>&hellip; although I buy the point here. If you are using <code>Optional</code>, typically you would use its methods that takes lambdas or such, which drags in some extra allocations. Again, should not be a problem unless it is proven to be a problem.</li>
</ul>
</li>
<li>Finally, what if <code>null</code> itself is <a href="https://stackoverflow.com/a/31923105">passed</a> the value for the <code>Optional</code> parameter? Duh! I am not denying this is a legit case although I see this as a problem of culture.
<ul>
<li>In Scala and other functional languages, there is a clear distinction in practice and convention between <code>null</code> and <code>Option</code>. I am yet to encounter a case where a piece of code dealing with <code>Option</code> received a <code>null</code>. For that matter, I am yet to come across code that was working with a <code>String</code> and encountered <code>null</code>. If a <code>String</code> were to be optional, it would have been an <code>Option[String]</code>. Validations at the highest levels may even wrap empty or blank <code>String</code>s into a <code>None</code>; depending on the case. I thought I would say that the above is practiced religiously. But no. It is just how Scala programmers, and generally speaking functional programmers think about it. It is sadly not the case with Java; at least mainstream<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>.</li>
</ul>
</li>
</ul>
<p>On a larger scale, I prefer to align with the community - practices, guidelines and conventions. And temper only specific things to cater to my taste/style. For a good reason. In the case of this warning about using <code>Optional</code> parameters, I have mixed feelings. Neither do I want to disable the inspection in IntelliJ because IntelliJ team is way smarter than us, and I hope they added it for a reason. Nor do I want litter my code with <code>SuppressWarnings</code><sup id="fnref1:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<p>Given that the IntelliJ inspection is a tooling aspect and general advice from elders, I <em>might</em> consider disabling it after all.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>The <code>case class</code> fields are getters and hence are returning <code>Option</code>. The constructor as written above is the argument. So, passing and returning.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Similar handling is not possible using <code>case class</code>; at least not in a clean way. You might end up having redundant fields breaking invariant on <code>attachment</code>. Or some unnecessarily convoluted code.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Yes, infamous. Because it is poorly implemented. I might have to write about it in separate post. Let me not digress.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>In the worst case you have to suppress the warning, use <code>@SuppressWarnings(&quot;OptionalUsedAsFieldOrParameterType&quot;)</code> instead of disabling the inspection for all cases.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>There are definitely some elite / esoteric Java code out there that fall in the category of functional thinking, if not really written using functional techniques.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</div>


	</main>

	<footer>
  <div>
    &copy;  2024

    

    
  </div>
</footer>


	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
		integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0=" crossorigin="anonymous"></script>

	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding:wght@400;700&display=swap" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/default.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/base16/ocean.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/scala.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/shell.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/cpp.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/fsharp.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/css.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://unpkg.com/lunr@2.3.9/lunr.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="/js/search.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	

	<script>
	window.store = {
	  
	  
	}

	hljs.highlightAll();

	document
		.querySelector('.blog-search-input')
		.addEventListener('keyup', function (event) {
			event.preventDefault();

			if (event.keyCode === 13) {
				document.querySelector('.blog-search-box>form>input').value = 
					document.querySelector('.blog-search-input').value;

				document
					.querySelector('.blog-search-box>form')
					.submit(
);
			}
		});
	</script>

	
</body>

</html>
