<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xml:lang="en" lang="en" >

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="generator" content="Hugo 0.92.2" />

	<title>A Paradox of Braces &middot; A Developer&#39;s Experience</title>

	<meta name="description" content="" />

	

<meta itemprop="name" content="A Paradox of Braces">
<meta itemprop="description" content="A great deal of thought goes into language design. Eric Lippert‚Äôs posts is a living testament, at least for C#."><meta itemprop="datePublished" content="2017-08-27T00:00:00+00:00" />
<meta itemprop="dateModified" content="2017-08-27T00:00:00+00:00" />
<meta itemprop="wordCount" content="620">
<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A Paradox of Braces"/>
<meta name="twitter:description" content="A great deal of thought goes into language design. Eric Lippert‚Äôs posts is a living testament, at least for C#."/>


<meta property="og:title" content="A Paradox of Braces" />
<meta property="og:description" content="A great deal of thought goes into language design. Eric Lippert‚Äôs posts is a living testament, at least for C#." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2017/12/106/paradox-of-braces/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-08-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2017-08-27T00:00:00+00:00" />




	<link type="text/css" rel="stylesheet" href="/css/print.css" media="print">

	<link type="text/css" rel="stylesheet" href="/css/poole.css">

	<link type="text/css" rel="stylesheet" href="/css/hyde.css">

	


	<link type="text/css" rel="stylesheet" href="/css/blockquote.css"><link type="text/css" rel="stylesheet" href="/css/custom.css">

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
		integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />

	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">

	<link rel="shortcut icon" href="/images/favicon.png">

	
	</head>

<body>
	<aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
        <div class="author-image">
          <a href="/">
            <img 
              src="/images/profile.png" 
              class="img-circle img-headshot center" 
              alt="Profile Picture">
          </a>
        </div>
        
      

      <h1>A Developer&#39;s Experience</h1>

      
      <p class="lead">The romantic image of an √ºber-programmer is someone who fires up Emacs, types like a machine gun, and delivers a flawless final product from scratch. A more accurate image would be someone who stares quietly into space for a few minutes and then says Hmm. I think I‚Äôve seen something like this before ‚Äì John D. Cook</p>
      
    </div>

    <hr />

    <nav>
      <ul class="sidebar-nav">
        
        <li>
          <a href="/post/">Posts</a>
        </li><li>
          <a href="/pages">Pages</a>
        </li><li>
          <a href="/about/">About</a>
        </li><li>
          <a href="/quotations">Qs</a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://stackoverflow.com/users/495612" rel="me" title="Stackoverflow" target="_blank">
        <i class="fab fa-stack-overflow" aria-hidden="true"></i>
      </a>
      
      <a href="https://github.com/vivekragunathan" rel="me" title="GitHub" target="_blank">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="https://twitter.com/higherkindedtpe" rel="me" title="Twitter" target="_blank">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      
    </section>

    <section class="blog-search-section">
      <div class="blog-search-box">
	
	<button class="blog-search-btn"><i class="fas fa-search"></i></button>
	<input type="text" class="blog-search-input" placeholder="Type to Search...">

	<form style='display: none;' action='/search/' method="get">
		<input name="q" type="text">
	</form>
</div>
    </section>
  </div>
</aside>


	<main class="content container">
		<div class="post">
  
  <div class="image featured ">
  	
	</div>

  <h1>A Paradox of Braces</h1>


  <div class="post-date">
    <time datetime="2017-08-27T00:00:00Z">Aug 27, 2017</time> &middot; 3 min read
  </div>

  <p>A great deal of thought goes into language design. Eric Lippert‚Äôs <a href="https://ericlippert.com">posts</a> is a living testament, at least for C#. Syntax and idioms are also part of the language design. When designing a language, the designers have to also consider its future. For instance, when designing C#, <a href="https://twitter.com/ahejlsberg">Anders</a> and others should have thought of and planned for what‚Äôs coming in then upcoming version(s) of C#. Such level of forethought might be seem daunting for an outsider. But the language designers are good at what they do, and most importantly, they know what they are doing. Well, in most cases!</p>
<p>In most cases? There are times when they either do not anticipate the introduction of a feature or its introduction interferes with what‚Äôs already existing. I am not talking about C#. I am talking about JavaScript.</p>
<p>A few years back, nobody would have thought that the language is going to get a pair of new shoes. Back then you would have been outlawed for uttering the word <code>classe</code>es. Nobody anticipated lambdas because you know JavaScript was already a functional programming language; or so they say. Everything could be solved with <code>function</code>s. You implement <code>class</code>es with <code>function</code>s while the reverse, although it makes sense (think function objects), was considered <em>not thinking in JavaScript</em>. Anyways, here comes the funny story.</p>
<p>Here is a simple one line ES6 lambda:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">x</span> <span class="o">+</span> <span class="mi">1</span>  
</code></pre></div><p>Here is a multiline lambda:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>  
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Processing item #</span><span class="si">${</span><span class="nx">index</span><span class="si">}</span><span class="sb"> ‚Ä¶`</span><span class="p">);</span>

  <span class="c1">// Imagine a few more lines of code to play with item.
</span><span class="c1"></span>
  <span class="k">return</span> <span class="p">{</span>  
    <span class="nx">userId</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">tokenData</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>  
    <span class="nx">fullName</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">lastName</span><span class="p">,</span>  
    <span class="nx">location</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">province</span>  
    <span class="c1">// Want more such ceremony?? üòù  
</span><span class="c1"></span>  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div><p>In the second snippet, the return value is an object (literal). You don‚Äôt need the block <code>{ .. }</code> with a <code>return</code> if you can express the return value as an expression (as in the one line lambda earlier). Ignoring the <em>few more lines of code</em> and the <em>ceremony</em> üòù, you could have this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>  
  <span class="nx">userId</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">tokenData</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>  
  <span class="nx">fullName</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">lastName</span><span class="p">,</span>  
  <span class="nx">location</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">province</span>  
<span class="p">}</span>
</code></pre></div><p>Like the one line lambda returning an integer, the above, technically, is one line lambda. Its‚Äô returning an object (literal). I have just wrapped/formatted the object literal (the way I usually do).</p>
<p>Except the above code won‚Äôt work. Duh!</p>
<p><strong><code>Uncaught SyntaxError: Unexpected token :</code></strong></p>
<p>The JavaScript parser is tricked into seeing the <strong><code>{</code></strong> as the beginning of a multiline lambda block and not as an object literal. Well, you can‚Äôt blame it. JavaScript did not see it coming; the language upgrade. Time and again, we put it off saying <code>function</code>s is just enough.</p>
<p>I suppose we cannot do anything much here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>  
  <span class="k">return</span> <span class="p">{</span>  
    <span class="nx">userId</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">tokenData</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>  
    <span class="nx">fullName</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">lastName</span><span class="p">,</span>  
    <span class="nx">location</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">province</span>  
  <span class="p">};</span>  
<span class="p">}</span>
</code></pre></div><p>Or by declaring <em>another</em> function that returns the object and call the function in the lambda:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">mapIt</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>  
  <span class="k">return</span> <span class="p">{</span>  
    <span class="nx">userId</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">tokenData</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>  
    <span class="nx">fullName</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">lastName</span><span class="p">,</span>  
    <span class="nx">location</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">province</span>  
  <span class="p">};</span>  
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">users</span> <span class="o">=</span> <span class="nx">items</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">item</span> <span class="p">=&gt;</span> <span class="nx">mapIt</span><span class="p">(</span><span class="nx">item</span><span class="p">));</span>  
</code></pre></div><p>I prefer the above rather than nesting <strong><code>{</code></strong> for the sake of satisfying the parser and having a dummy <code>return</code>.</p>
<p>Also, JavaScript‚Äôs closest kin, Typescript, wouldn‚Äôt be able to help us here. Because Typescript <em>augments</em> JavaScript, and doesn‚Äôt invalidate any existing JavaScript constructs.</p>
<p>I am sure I am not the first to discover this. But I couldn‚Äôt stop laughing to myself when I encountered this.</p>
<p><strong>UPDATE</strong></p>
<p>Instead of the above workarounds, I came across a cleaner way:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span>  
  <span class="nx">userId</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">tokenData</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>  
  <span class="nx">fullName</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">lastName</span><span class="p">,</span>  
  <span class="nx">location</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">address</span><span class="p">.</span><span class="nx">province</span>  
<span class="p">});</span>
</code></pre></div><p>Still squinting your eyes? Notice the object literal shoved inside <code>()</code>.</p>

</div>


	</main>

	<footer>
  <div>
    &copy;  2022

    &middot; <a href="https://creativecommons.org/licenses/by-sa/4.0" target="_blank">CC BY-SA 4.0</a>

    
  </div>
</footer>


	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
		integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0=" crossorigin="anonymous"></script>

	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding:wght@400;700&display=swap" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/default.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/base16/ocean.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/scala.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/shell.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/cpp.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/fsharp.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/css.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://unpkg.com/lunr@2.3.9/lunr.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="/js/search.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	

	<script>
	window.store = {
	  
	  
	}

	hljs.highlightAll();

	document
		.querySelector('.blog-search-input')
		.addEventListener('keyup', function (event) {
			event.preventDefault();

			if (event.keyCode === 13) {
				document.querySelector('.blog-search-box>form>input').value = 
					document.querySelector('.blog-search-input').value;

				document
					.querySelector('.blog-search-box>form')
					.submit(
);
			}
		});
	</script>

	
</body>

</html>
